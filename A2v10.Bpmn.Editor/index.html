<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>BPMN Editor</title>
	<link rel="stylesheet" href="/css/bpmn/diagram-js.css">
	<link rel="stylesheet" href="/css/bpmn/bpmn-font/bpmn.css">
	<link rel="stylesheet" href="/css/bpmn/bpmn-js-properties-panel.css">
	<link rel="stylesheet" href="/css/editor.css">
</head>
<body>
	<div class="editor-canvas" id="canvas"></div>
	<div class="properties-panel-parent" id="js-properties-panel"></div>

	<div style="position:absolute;bottom:20px;left:20px">
		<button id="logBtn">LOG</button>
	</div>

	<div style="position:absolute;bottom:20px;right:350px;display:flex;gap:10px">
		<button id="zoomMinusBtn">zoom-</button>
		<button id="zoomPlusBtn">zoom+</button>
	</div>

	<script type="text/javascript" src="/dist/bpmn-editor.js"></script>
	<script type="text/javascript">
		(async function () {
			const bpmnModeler = window.BpmnModeler.create("canvas", "js-properties-panel");
			let wf = await fetch('/workflows/default.bpmn');
			bpmnModeler.importXML(await wf.text());
			document.getElementById('logBtn').addEventListener('click', async () => {
				console.dir(bpmnModeler);
				let xml = await bpmnModeler.saveXML();
				console.log(xml.xml);
			});
			document.getElementById('zoomPlusBtn').addEventListener('click', () => {
				let cv = bpmnModeler.get('canvas');
				console.dir(cv);
				let zl = cv.zoom();
				zl += .5;
				cv.zoom(zl);
				cv.zoom('fit-viewport');
			});
			document.getElementById('zoomMinusBtn').addEventListener('click', () => {
				console.dir(bpmnModeler);
				let cv = bpmnModeler.get('canvas');
				let zl = cv.zoom();
				zl -= .5;
				cv.zoom(zl, 'fit-viewport');
			});
		})();
	</script>
</body>
</html>